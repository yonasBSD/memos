import{j as t,D as h}from"./mui-vendor.BwEHDYNi.js";import{u as w,j as g,w as y,x as j,f as v,y as I,z as N,I as P,l as k,h as b}from"./app.BmPucvBz.js";import{a as o,L as U}from"./react-vendor.DIaRSUZC.js";import{A as S}from"./AuthFooter.DLwdxxHu.js";import{P as L}from"./PasswordSignInForm.B25SfgdN.js";import"./utils-vendor.gMQV7HrB.js";import"./mermaid-vendor.YaF7NM7v.js";import"./highlight-vendor.BCvQicfw.js";import"./katex-vendor.BOojJMwU.js";import"./leaflet-vendor.BDS7nALv.js";import"./LocaleSelect.qnFSfcoT.js";const W=()=>{var l,c;const r=w(),d=g(),[n,u]=o.useState([]),s=y.state.generalSetting;o.useEffect(()=>{d&&(window.location.href=j.ROOT)},[]),o.useEffect(()=>{(async()=>{const{identityProviders:a}=await I.listIdentityProviders({});u(a)})()},[]);const f=async e=>{var m;const a="auth.signin.".concat(e.title,"-").concat(N(e.name));if(e.type===P.OAUTH2){const p=k("/auth/callback"),i=(m=e.config)==null?void 0:m.oauth2Config;if(!i){b.error("Identity provider configuration is invalid.");return}const x="".concat(i.authUrl,"?client_id=").concat(i.clientId,"&redirect_uri=").concat(p,"&state=").concat(a,"&response_type=code&scope=").concat(encodeURIComponent(i.scopes.join(" ")));window.location.href=x}};return t.jsxs("div",{className:"py-4 sm:py-8 w-80 max-w-full min-h-[100svh] mx-auto flex flex-col justify-start items-center",children:[t.jsxs("div",{className:"w-full py-4 grow flex flex-col justify-center items-center",children:[t.jsxs("div",{className:"w-full flex flex-row justify-center items-center mb-6",children:[t.jsx("img",{className:"h-14 w-auto rounded-full shadow",src:((l=s.customProfile)==null?void 0:l.logoUrl)||"/logo.webp",alt:""}),t.jsx("p",{className:"ml-2 text-5xl text-black opacity-80 dark:text-gray-200",children:((c=s.customProfile)==null?void 0:c.title)||"Memos"})]}),s.disallowPasswordAuth?t.jsx("p",{className:"w-full text-2xl mt-2 dark:text-gray-500",children:"Password auth is not allowed."}):t.jsx(L,{}),!s.disallowUserRegistration&&!s.disallowPasswordAuth&&t.jsxs("p",{className:"w-full mt-4 text-sm",children:[t.jsx("span",{className:"dark:text-gray-500",children:r("auth.sign-up-tip")}),t.jsx(U,{to:"/auth/signup",className:"cursor-pointer ml-2 text-blue-600 hover:underline",viewTransition:!0,children:r("common.sign-up")})]}),n.length>0&&t.jsxs(t.Fragment,{children:[t.jsx(h,{className:"!my-4",children:r("common.or")}),t.jsx("div",{className:"w-full flex flex-col space-y-2",children:n.map(e=>t.jsx(v,{className:"bg-white dark:bg-black",variant:"outlined",fullWidth:!0,onClick:()=>f(e),children:r("common.sign-in-with",{provider:e.title})},e.name))})]})]}),t.jsx(S,{})]})};export{W as default};
