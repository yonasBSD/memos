import{j as e,T as f}from"./mui-vendor.BwEHDYNi.js";import{o as E,s as M}from"./utils-vendor.gMQV7HrB.js";import{a as n}from"./react-vendor.DIaRSUZC.js";import{m as I,u as y,a as C,p as A,C as S,F as R,G as z,A as m,c as p,H as a,L as T,V as D,o as U,n as H,J as V,E as $,K as B}from"./app.BmPucvBz.js";import{M as F}from"./message-circle.BoxpxnjK.js";import"./mermaid-vendor.YaF7NM7v.js";import"./highlight-vendor.BCvQicfw.js";import"./katex-vendor.BOojJMwU.js";import"./leaflet-vendor.BDS7nALv.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=I("Inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]),O=({inbox:t})=>{var d;const l=y(),c=C(),s=A(),[i,h]=n.useState(void 0),[r,j]=n.useState(void 0),[g,v]=n.useState(!1);S(async()=>{var x;if(!t.activityId)return;const o=await R.getActivity({name:"".concat(z).concat(t.activityId)});if((x=o.payload)!=null&&x.memoComment){const w=o.payload.memoComment,b=await s.getOrFetchMemoByName(w.relatedMemo,{skipStore:!0});h(b);const k=await m.getOrFetchUserByName(t.sender);j(k),v(!0)}},[t.activityId]);const N=async()=>{i&&(c("/".concat(i.name)),t.status===a.UNREAD&&u(!0))},u=async(o=!1)=>{await m.updateInbox({name:t.name,status:a.ARCHIVED},["status"]),o||D.success(l("message.archived-successfully"))};return e.jsxs("div",{className:"w-full flex flex-row justify-start items-start gap-3",children:[e.jsx("div",{className:p("shrink-0 mt-2 p-2 rounded-full border",t.status===a.UNREAD?"border-blue-600 text-blue-600 bg-blue-50 dark:bg-zinc-800":"border-gray-500 text-gray-500 bg-gray-50 dark:bg-zinc-800"),children:e.jsx(f,{title:"Comment",placement:"bottom",children:e.jsx(F,{className:"w-4 sm:w-5 h-auto"})})}),e.jsx("div",{className:p("border w-full p-2 px-3 rounded-lg flex flex-col justify-start items-start gap-1 dark:border-zinc-700 hover:bg-gray-100 dark:hover:bg-zinc-700",t.status!==a.UNREAD&&"opacity-60"),children:g?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"w-full flex flex-row justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-500",children:(d=t.createTime)==null?void 0:d.toLocaleString()}),e.jsx("div",{children:t.status===a.UNREAD&&e.jsx(f,{title:l("common.archive"),placement:"top",children:e.jsx(L,{className:"w-4 h-auto cursor-pointer text-gray-400 hover:text-blue-600",onClick:()=>u()})})})]}),e.jsx("p",{className:"text-base leading-tight cursor-pointer text-gray-500 dark:text-gray-400 hover:underline hover:text-blue-600",onClick:N,children:l("inbox.memo-comment",{user:(r==null?void 0:r.nickname)||(r==null?void 0:r.username),memo:i==null?void 0:i.name,interpolation:{escapeValue:!1}})})]}):e.jsx("div",{className:"w-full flex flex-row justify-center items-center my-2",children:e.jsx(T,{className:"animate-spin text-zinc-500"})})})]})},Y=E(()=>{const t=y(),{md:l}=U(),c=M(m.state.inboxes,s=>s.status===a.UNREAD?0:s.status===a.ARCHIVED?1:2);return n.useEffect(()=>{m.fetchInboxes()},[]),e.jsxs("section",{className:"@container w-full max-w-5xl min-h-full flex flex-col justify-start items-center sm:pt-3 md:pt-6 pb-8",children:[!l&&e.jsx(H,{}),e.jsx("div",{className:"w-full px-4 sm:px-6",children:e.jsxs("div",{className:"w-full shadow flex flex-col justify-start items-start px-4 py-3 rounded-xl bg-white dark:bg-zinc-800 text-black dark:text-gray-300",children:[e.jsx("div",{className:"relative w-full flex flex-row justify-between items-center",children:e.jsxs("p",{className:"py-1 flex flex-row justify-start items-center select-none opacity-80",children:[e.jsx(V,{className:"w-6 h-auto mr-1 opacity-80"}),e.jsx("span",{className:"text-lg",children:t("common.inbox")})]})}),e.jsxs("div",{className:"w-full h-auto flex flex-col justify-start items-start px-2 pb-4",children:[c.length===0&&e.jsxs("div",{className:"w-full mt-4 mb-8 flex flex-col justify-center items-center italic",children:[e.jsx($,{}),e.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:t("message.no-data")})]}),e.jsx("div",{className:"flex flex-col justify-start items-start w-full mt-4 gap-4",children:c.map(s=>{if(s.type===B.MEMO_COMMENT)return e.jsx(O,{inbox:s},"".concat(s.name,"-").concat(s.status))})})]})]})})]})});export{Y as default};
